events {
}

http {
  server {
    listen 80;

    proxy_set_header X-Forwarded-For $proxy_protocol_addr; # To forward the original client's IP address
    proxy_set_header X-Forwarded-Proto $scheme; # to forward the original protocol (HTTP or HTTPS)
    proxy_set_header Host $http_host; # to forward the original host requested by the client

    location / {
      root /usr/share/nginx/html;
      index index.html index.htm;
      try_files $uri $uri/ /index.html =404;
    }

    location /hello-world {
      rewrite /hello-world/(.*) /$1 break;
      proxy_pass http://test-app;
    }

    location /infra {
      proxy_pass http://infra;
    }

    location /wtps {
      rewrite /wtps/(.*) /$1 break;
      proxy_pass http://wtps;
    }

    location /auth {
      proxy_pass http://auth:8080;
    }

    location /capital-resources/ {
      rewrite /capital-resources/(.*) /$1 break;
      proxy_pass http://capital-resources;
    }
  }
}
